#!/bin/bash

# í•œíˆ¬ í€€íŠ¸ í”„ë¡œì íŠ¸ ë¬¸ì„œ ë™ê¸°í™” pre-commit hook

echo "ğŸ”„ ë¬¸ì„œ ë™ê¸°í™” í™•ì¸ ì¤‘..."

# TODO ìƒíƒœ ë³€ê²½ì´ ìˆëŠ”ì§€ í™•ì¸
if git diff --cached --name-only | grep -E "(todos\.json|PROJECT_SUMMARY\.md|ROADMAP\.md)" > /dev/null; then
    echo "ğŸ“‹ TODO ë˜ëŠ” í”„ë¡œì íŠ¸ ë¬¸ì„œ ë³€ê²½ ê°ì§€ë¨"
    
    # Python ë¬¸ì„œ ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
    if [ -f "scripts/doc_sync_automation.py" ]; then
        echo "ğŸš€ ë¬¸ì„œ ë™ê¸°í™” ìë™í™” ì‹¤í–‰ ì¤‘..."
        python3 scripts/doc_sync_automation.py
        
        # ë³€ê²½ëœ íŒŒì¼ë“¤ì„ ìŠ¤í…Œì´ì§• ì˜ì—­ì— ì¶”ê°€
        git add .cursor/rules/project-status.mdc
        git add .cursor/rules/implementation_checklist.md
        git add PROJECT_SUMMARY.md
        git add ROADMAP.md
        git add STATUS_REPORT.md
        git add .ai/history/
        
        echo "âœ… ë¬¸ì„œ ë™ê¸°í™” ì™„ë£Œ ë° ìŠ¤í…Œì´ì§•ë¨"
    else
        echo "âš ï¸ ë¬¸ì„œ ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
    fi
else
    echo "ğŸ“„ ë¬¸ì„œ ë™ê¸°í™”ê°€ í•„ìš”í•œ ë³€ê²½ì‚¬í•­ ì—†ìŒ"
fi

echo "âœ¨ pre-commit í™•ì¸ ì™„ë£Œ"
exit 0 